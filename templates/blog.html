{% extends "base.html" %}

{% block title %}Our Blog - Web Asset Suite{% endblock %}

{% block content %}
<div class="blog-header">
    <div class="container">
        <h1>From Our Toolbox <br>to <span style="color: var(--accent-secondary);">Your Workflow</span></h1>
        <p>Explore expert tips, tutorials, and the latest trends in web design to help you get the most out of the Web Asset Suite.</p>
        <div class="category-filters">
            <a href="{{ url_for('blog_list') }}" class="filter-btn {% if not selected_category_slug %}active{% endif %}">All</a>
            {% for category in categories %}
            <a href="{{ url_for('blog_list', category=category.slug) }}" class="filter-btn {% if selected_category_slug == category.slug %}active{% endif %}">{{ category.name }}</a>
            {% endfor %}
        </div>
    </div>
</div>

<div class="container" style="margin-top: 50px;">
    <div class="blog-grid">
        {% for post in posts.items %}
        <a href="{{ url_for('view_post', slug=post.slug) }}" class="blog-card">
            
            {% set image_url = url_for('uploaded_file', filename=post.featured_image) if post.featured_image else url_for('static', filename='img/default-blog.png') %}
            <div class="blog-card-image" style="background-image: url('{{ image_url }}');">

                {% if post.category %}
                <span class="blog-card-category">{{ post.category.name }}</span>
                {% endif %}
            </div>
            <div class="blog-card-content">
                <p class="blog-card-date">{{ post.pub_date.strftime('%B %d, %Y') }}</p>
                <h3 class="blog-card-title">{{ post.title }}</h3>
                <p class="blog-card-excerpt">{{ post.content | striptags | truncate(120) }}</p>
                <span class="blog-card-readmore">Read More &rarr;</span>
            </div>
        </a>
        {% else %}
        <p style="grid-column: 1 / -1; text-align: center; color: var(--text-secondary);">No blog posts found in this category.</p>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if posts.pages > 1 %}
    <div class="pagination">
        {% if posts.has_prev %}
            <a href="{{ url_for('blog_list', page=posts.prev_num, category=selected_category_slug) }}" class="btn btn-secondary">&laquo; Previous</a>
        {% endif %}
        <span class="page-info">Page {{ posts.page }} of {{ posts.pages }}</span>
        {% if posts.has_next %}
            <a href="{{ url_for('blog_list', page=posts.next_num, category=selected_category_slug) }}" class="btn btn-secondary">Next &raquo;</a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}